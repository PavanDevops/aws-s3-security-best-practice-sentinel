import "tfplan/v2" as tfplan
deny_s3_public_read_write_acl = rule {
	all filter tfplan.resource_changes as _, rc {
		rc.type is "aws_s3_bucket" and
			rc.mode is "managed" and
			rc.change.actions is ["create"]
	} as _, frc {
		frc.change.after.acl is not "public-read-write"
	}
}

main = rule {
	deny_s3_public_read_write_acl
}